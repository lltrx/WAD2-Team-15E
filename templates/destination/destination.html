{% extends 'destination/base.html' %} {% load staticfiles %}
    
    {% block title %} Destinations {% endblock %}
    
    {% block title_block %}
    {% if destination %}
        {{ destination.name }}
    {% else %}
        Unknown destination
    {% endif %}
{% endblock %}

{% block body_block %}
    {% if destination %}
    <h1>{{ destination.name }}</h1>

    {% if destination.author == request.user %}
        <a href="{% url 'destination:edit_destination' destination.slug %}">Edit Destination</a><br />
    {% endif %} 

    {% if destination.image %}
      <img src="{{ destination.image.url }}">
    {% endif %}
    <p>Type: {{ destination.get_destination_type_display }}</p>

    <p>{{ destination.description }}</p>

    {% if destination.author != null %}
        <a href="{% url 'destination:user_profile' destination.author %}">view the author's profile</a>
    {% endif %}

    
    <form action="{% url 'destination:like_destination' destination.slug %}" method="POST">
        {% csrf_token %}
        <button type="submit", name="post_id", value="{{ post.id }}",class="btn btn-outline-dark">Like</button>
        {{ total_likes }} likes
    </form>
    <div class="card">
        <div class="card-header">
    <h3>Comments</h3>
        </div>
        
    {% if not destination.comments.all %}
    <div class="card-body">
        No comments yet.. 
    </div>
    {% else %}
        {% for comment in destination.comments.all %}
        <div class="card-body">
                {% if user.userprofile.picture %}
                    <img src="{{ user_profile.picture.url }}">
                {% else %}
                    <img src="{% static 'images/user_pic_placeholder.png' %}">
                {% endif %}
            <strong> {{ comment.user }} 
                On {{ comment.created_date }} </strong>
                <br />
                <blockquote class="blockquote mb-0">
            <p> {{ comment.text }} </p>
            <footer class="blockquote-footer">  Rate: {{ comment.rate }} </footer>
        </blockquote>
    </div>
    </div>
        {% endfor %}
    {% endif %} 
    <br />
    {%if user.is_authenticated %}
    </p>
    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
      Add comment
      </button>
    </p>
    <div class="collapse" id="collapseExample">
        <div class="card card-body">
        <form method="post" action=".">
             {% csrf_token %}
             {{ form.as_table }}

                <button type="submit" class="btn btn-outline-dark">Submit</button>
        </form>
        </div>
    </div>
    {% endif %}


    {%if user.is_authenticated %}
        
    {%endif%}
    {% else %}
    The specified destination does not exist.
    {% endif %}
{% endblock %}
 